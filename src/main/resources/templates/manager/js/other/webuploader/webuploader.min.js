isWebuploader=window.isWebuploader=true;!function(C,D){var E,F={},G=function(K,L){var M,N,O;if("string"==typeof K){return J(K)}for(M=[],N=K.length,O=0;N>O;O++){M.push(J(K[O]))}return L.apply(null,M)},H=function(K,L,M){2===arguments.length&&(M=L,L=null),G(L||[],function(){I(K,M,arguments)})},I=function(K,L,M){var N,O={exports:L};"function"==typeof L&&(M.length||(M=[G,O.exports,O]),N=L.apply(null,M),void 0!==N&&(O.exports=N)),F[K]=O.exports},J=function(K){var L=F[K]||C[K];if(!L){throw new Error("`"+K+"` is undefined")}return L},A=function(L){var M,N,O,P,Q,K;K=function(R){return R&&R.charAt(0).toUpperCase()+R.substr(1)};for(M in F){if(N=L,F.hasOwnProperty(M)){for(O=M.split("/"),Q=K(O.pop());P=K(O.shift());){N[P]=N[P]||{},N=N[P]}N[Q]=F[M]}}return L},B=function(K){return C.__dollar=K,A(D(C,H,G))};"object"==typeof module&&"object"==typeof module.exports?module.exports=B():"function"==typeof define&&define.amd?define(["jquery"],B):(E=C.WebUploader,C.WebUploader=B(),C.WebUploader.noConflict=function(){C.WebUploader=E})}(window,function(A,B,C){return B("dollar-third",[],function(){var D=A.__dollar||A.jQuery||A.Zepto;if(!D){throw new Error("jQuery or Zepto not found!")}return D}),B("dollar",["dollar-third"],function(D){return D}),B("promise-third",["dollar"],function(D){return{Deferred:D.Deferred,when:D.when,isPromise:function(E){return E&&"function"==typeof E.then}}}),B("promise",["promise-third"],function(D){return D}),B("base",["dollar","promise"],function(E,F){function G(K){return function(){return D.apply(K,arguments)}}function H(K,L){return function(){return K.apply(L,arguments)}}function I(K){var L;return Object.create?Object.create(K):(L=function(){},L.prototype=K,new L)}var J=function(){},D=Function.call;return{version:"0.1.5",$:E,Deferred:F.Deferred,isPromise:F.isPromise,when:F.when,browser:function(K){var L={},M=K.match(/WebKit\/([\d.]+)/),N=K.match(/Chrome\/([\d.]+)/)||K.match(/CriOS\/([\d.]+)/),O=K.match(/MSIE\s([\d\.]+)/)||K.match(/(?:trident)(?:.*rv:([\w.]+))?/i),P=K.match(/Firefox\/([\d.]+)/),Q=K.match(/Safari\/([\d.]+)/),R=K.match(/OPR\/([\d.]+)/);return M&&(L.webkit=parseFloat(M[1])),N&&(L.chrome=parseFloat(N[1])),O&&(L.ie=parseFloat(O[1])),P&&(L.firefox=parseFloat(P[1])),Q&&(L.safari=parseFloat(Q[1])),R&&(L.opera=parseFloat(R[1])),L}(navigator.userAgent),os:function(K){var L={},M=K.match(/(?:Android);?[\s\/]+([\d.]+)?/),N=K.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);return M&&(L.android=parseFloat(M[1])),N&&(L.ios=parseFloat(N[1].replace(/_/g,"."))),L}(navigator.userAgent),inherits:function(K,L,M){var N;return"function"==typeof L?(N=L,L=null):N=L&&L.hasOwnProperty("constructor")?L.constructor:function(){return K.apply(this,arguments)},E.extend(!0,N,K,M||{}),N.__super__=K.prototype,N.prototype=I(K.prototype),L&&E.extend(!0,N.prototype,L),N},noop:J,bindFn:H,log:function(){return A.console?H(console.log,console):J}(),nextTick:function(){return function(K){setTimeout(K,1)}}(),slice:G([].slice),guid:function(){var K=0;return function(L){for(var M=(+new Date).toString(32),N=0;5>N;N++){M+=Math.floor(65535*Math.random()).toString(32)}return(L||"wu_")+M+(K++).toString(32)}}(),formatSize:function(K,L,M){var N;for(M=M||["B","K","M","G","TB"];(N=M.shift())&&K>1024;){K/=1024}return("B"===N?K:K.toFixed(L||2))+N}}}),B("mediator",["base"],function(D){function E(L,M,N,O){return I.grep(L,function(P){return !(!P||M&&P.e!==M||N&&P.cb!==N&&P.cb._cb!==N||O&&P.ctx!==O)})}function F(L,M,N){I.each((L||"").split(K),function(O,P){N(P,M)})}function G(L,M){for(var N,O=!1,P=-1,Q=L.length;++P<Q;){if(N=L[P],N.cb.apply(N.ctx2,M)===!1){O=!0;break}}return !O}var H,I=D.$,J=[].slice,K=/\s+/;return H={on:function(L,M,N){var O,P=this;return M?(O=this._events||(this._events=[]),F(L,M,function(Q,R){var S={e:Q};S.cb=R,S.ctx=N,S.ctx2=N||P,S.id=O.length,O.push(S)}),this):this},once:function(L,M,N){var O=this;return M?(F(L,M,function(P,Q){var R=function(){return O.off(P,R),Q.apply(N||O,arguments)};R._cb=Q,O.on(P,R,N)}),O):O},off:function(L,M,N){var O=this._events;return O?L||M||N?(F(L,M,function(P,Q){I.each(E(O,P,Q,N),function(){delete O[this.id]})}),this):(this._events=[],this):this},trigger:function(L){var M,N,O;return this._events&&L?(M=J.call(arguments,1),N=E(this._events,L),O=E(this._events,"all"),G(N,M)&&G(O,arguments)):this}},I.extend({installTo:function(L){return I.extend(L,H)}},H)}),B("uploader",["base","mediator"],function(D,E){function F(H){this.options=G.extend(!0,{},F.options,H),this._init(this.options)}var G=D.$;return F.options={},E.installTo(F.prototype),G.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",cancelFile:"cancel-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",md5File:"md5-file",getDimension:"get-dimension",addButton:"add-btn",predictRuntimeType:"predict-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(H,I){F.prototype[H]=function(){return this.request(I,arguments)}}),G.extend(F.prototype,{state:"pending",_init:function(H){var I=this;I.request("init",H,function(){I.state="ready",I.trigger("ready")})},option:function(H,I){var J=this.options;return arguments.length>1?void (G.isPlainObject(I)&&G.isPlainObject(J[H])?G.extend(J[H],I):J[H]=I):H?J[H]:J},getStats:function(){var H=this.request("get-stats");return H?{successNum:H.numOfSuccess,progressNum:H.numOfProgress,cancelNum:H.numOfCancel,invalidNum:H.numOfInvalid,uploadFailNum:H.numOfUploadFailed,queueNum:H.numOfQueue,interruptNum:H.numofInterrupt}:{}},trigger:function(H){var I=[].slice.call(arguments,1),J=this.options,K="on"+H.substring(0,1).toUpperCase()+H.substring(1);return E.trigger.apply(this,arguments)===!1||G.isFunction(J[K])&&J[K].apply(this,I)===!1||G.isFunction(this[K])&&this[K].apply(this,I)===!1||E.trigger.apply(E,[this,H].concat(I))===!1?!1:!0},destroy:function(){this.request("destroy",arguments),this.off()},request:D.noop}),D.create=F.create=function(H){return new F(H)},D.Uploader=F,F}),B("runtime/runtime",["base","mediator"],function(D,E){function F(J){this.options=G.extend({container:document.body},J),this.uid=D.guid("rt_")}var G=D.$,H={},I=function(J){for(var K in J){if(J.hasOwnProperty(K)){return K}}return null};return G.extend(F.prototype,{getContainer:function(){var J,K,L=this.options;return this._container?this._container:(J=G(L.container||document.body),K=G(document.createElement("div")),K.attr("id","rt_"+this.uid),K.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),J.append(K),J.addClass("webuploader-container"),this._container=K,this._parent=J,K)},init:D.noop,exec:D.noop,destroy:function(){this._container&&this._container.remove(),this._parent&&this._parent.removeClass("webuploader-container"),this.off()}}),F.orders="html5,flash",F.addRuntime=function(J,K){H[J]=K},F.hasRuntime=function(J){return !!(J?H[J]:I(H))},F.create=function(J,K){var M,L;if(K=K||F.orders,G.each(K.split(/\s*,\s*/g),function(){return H[this]?(M=this,!1):void 0}),M=M||I(H),!M){throw new Error("Runtime Error")}return L=new H[M](J)},E.installTo(F.prototype),F}),B("runtime/client",["base","mediator","runtime/runtime"],function(D,E,F){function G(I,J){var K,L=D.Deferred();this.uid=D.guid("client_"),this.runtimeReady=function(M){return L.done(M)},this.connectRuntime=function(M,N){if(K){throw new Error("already connected!")}return L.done(N),"string"==typeof M&&H.get(M)&&(K=H.get(M)),K=K||H.get(null,J),K?(D.$.extend(K.options,M),K.__promise.then(L.resolve),K.__client++):(K=F.create(M,M.runtimeOrder),K.__promise=L.promise(),K.once("ready",L.resolve),K.init(),H.add(K),K.__client=1),J&&(K.__standalone=J),K},this.getRuntime=function(){return K},this.disconnectRuntime=function(){K&&(K.__client--,K.__client<=0&&(H.remove(K),delete K.__promise,K.destroy()),K=null)},this.exec=function(){if(K){var M=D.slice(arguments);return I&&M.unshift(I),K.exec.apply(this,M)}},this.getRuid=function(){return K&&K.uid},this.destroy=function(M){return function(){M&&M.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()}}(this.destroy)}var H;return H=function(){var I={};return{add:function(J){I[J.uid]=J},get:function(J,K){var L;if(J){return I[J]}for(L in I){if(!K||!I[L].__standalone){return I[L]}}return null},remove:function(J){delete I[J.uid]}}}(),E.installTo(G.prototype),G}),B("lib/dnd",["base","mediator","runtime/client"],function(D,E,F){function G(I){I=this.options=H.extend({},G.options,I),I.container=H(I.container),I.container.length&&F.call(this,"DragAndDrop")}var H=D.$;return G.options={accept:null,disableGlobalDnd:!1},D.inherits(F,{constructor:G,init:function(){var I=this;I.connectRuntime(I.options,function(){I.exec("init"),I.trigger("ready")})}}),E.installTo(G.prototype),G}),B("widgets/widget",["base","uploader"],function(E,F){function G(M){if(!M){return !1}var N=M.length,O=I.type(M);return 1===M.nodeType&&N?!0:"array"===O||"function"!==O&&"string"!==O&&(0===N||"number"==typeof N&&N>0&&N-1 in M)}function H(M){this.owner=M,this.options=M.options}var I=E.$,J=F.prototype._init,K=F.prototype.destroy,L={},D=[];return I.extend(H.prototype,{init:E.noop,invoke:function(M,N){var O=this.responseMap;return O&&M in O&&O[M] in this&&I.isFunction(this[O[M]])?this[O[M]].apply(this,N):L},request:function(){return this.owner.request.apply(this.owner,arguments)}}),I.extend(F.prototype,{_init:function(){var M=this,N=M._widgets=[],O=M.options.disableWidgets||"";return I.each(D,function(P,Q){(!O||!~O.indexOf(Q._name))&&N.push(new Q(M))}),J.apply(M,arguments)},request:function(T,U,V){var W,X,M,N,O=0,P=this._widgets,Q=P&&P.length,R=[],S=[];for(U=G(U)?U:[U];Q>O;O++){W=P[O],X=W.invoke(T,U),X!==L&&(E.isPromise(X)?S.push(X):R.push(X))}return V||S.length?(M=E.when.apply(E,S),N=M.pipe?"pipe":"then",M[N](function(){var Y=E.Deferred(),Z=arguments;return 1===Z.length&&(Z=Z[0]),setTimeout(function(){Y.resolve(Z)},1),Y.promise()})[V?N:"done"](V||E.noop)):R[0]},destroy:function(){K.apply(this,arguments),this._widgets=null}}),F.register=H.register=function(M,N){var O,P={init:"init",destroy:"destroy",name:"anonymous"};return 1===arguments.length?(N=M,I.each(N,function(Q){return"_"===Q[0]||"name"===Q?void ("name"===Q&&(P.name=N.name)):void (P[Q.replace(/[A-Z]/g,"-$&").toLowerCase()]=Q)})):P=I.extend(P,M),N.responseMap=P,O=E.inherits(H,N),O._name=P.name,D.push(O),O},F.unRegister=H.unRegister=function(M){if(M&&"anonymous"!==M){for(var N=D.length;N--;){D[N]._name===M&&D.splice(N,1)}}},H}),B("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(D,E,F){var G=D.$;return E.options.dnd="",E.register({name:"dnd",init:function(H){if(H.dnd&&"html5"===this.request("predict-runtime-type")){var J,K=this,L=D.Deferred(),I=G.extend({},{disableGlobalDnd:H.disableGlobalDnd,container:H.dnd,accept:H.accept});return this.dnd=J=new F(I),J.once("ready",L.resolve),J.on("drop",function(M){K.request("add-file",[M])}),J.on("accept",function(M){return K.owner.trigger("dndAccept",M)}),J.init(),L.promise()}},destroy:function(){this.dnd&&this.dnd.destroy()}})}),B("lib/filepaste",["base","mediator","runtime/client"],function(D,E,F){function G(I){I=this.options=H.extend({},I),I.container=H(I.container||document.body),F.call(this,"FilePaste")}var H=D.$;return D.inherits(F,{constructor:G,init:function(){var I=this;I.connectRuntime(I.options,function(){I.exec("init"),I.trigger("ready")})}}),E.installTo(G.prototype),G}),B("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(D,E,F){var G=D.$;return E.register({name:"paste",init:function(H){if(H.paste&&"html5"===this.request("predict-runtime-type")){var J,K=this,L=D.Deferred(),I=G.extend({},{container:H.paste,accept:H.accept});return this.paste=J=new F(I),J.once("ready",L.resolve),J.on("paste",function(M){K.owner.request("add-file",[M])}),J.init(),L.promise()}},destroy:function(){this.paste&&this.paste.destroy()}})}),B("lib/blob",["base","runtime/client"],function(D,E){function F(G,H){var I=this;I.source=H,I.ruid=G,this.size=H.size||0,this.type=!H.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)?"image/"+("jpg"===this.ext?"jpeg":this.ext):H.type||"application/octet-stream",E.call(I,"Blob"),this.uid=H.uid||this.uid,G&&I.connectRuntime(G)}return D.inherits(E,{constructor:F,slice:function(G,H){return this.exec("slice",G,H)},getSource:function(){return this.source}}),F}),B("lib/file",["base","lib/blob"],function(D,E){function F(I,J){var K;this.name=J.name||"untitled"+G++,K=H.exec(J.name)?RegExp.$1.toLowerCase():"",!K&&J.type&&(K=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(J.type)?RegExp.$1.toLowerCase():"",this.name+="."+K),this.ext=K,this.lastModifiedDate=J.lastModifiedDate||(new Date).toLocaleString(),E.apply(this,arguments)}var G=1,H=/\.([^.]+)$/;return D.inherits(E,F)}),B("lib/filepicker",["base","runtime/client","lib/file"],function(D,E,F){function G(I){if(I=this.options=H.extend({},G.options,I),I.container=H(I.id),!I.container.length){throw new Error("按钮指定错误")}I.innerHTML=I.innerHTML||I.label||I.container.html()||"",I.button=H(I.button||document.createElement("div")),I.button.html(I.innerHTML),I.container.html(I.button),E.call(this,"FilePicker",!0)}var H=D.$;return G.options={button:null,container:null,label:null,innerHTML:null,multiple:!0,accept:null,name:"file"},D.inherits(E,{constructor:G,init:function(){var I=this,J=I.options,K=J.button;K.addClass("webuploader-pick"),I.on("all",function(L){var M;switch(L){case"mouseenter":K.addClass("webuploader-pick-hover");break;case"mouseleave":K.removeClass("webuploader-pick-hover");break;case"change":M=I.exec("getFiles"),I.trigger("select",H.map(M,function(N){return N=new F(I.getRuid(),N),N._refer=J.container,N}),J.container)}}),I.connectRuntime(J,function(){I.refresh(),I.exec("init",J),I.trigger("ready")}),this._resizeHandler=D.bindFn(this.refresh,this),H(A).on("resize",this._resizeHandler)},refresh:function(){var I=this.getRuntime().getContainer(),J=this.options.button,K=J.outerWidth?J.outerWidth():J.width(),L=J.outerHeight?J.outerHeight():J.height(),M=J.offset();K&&L&&I.css({bottom:"auto",right:"auto",width:K+"px",height:L+"px"}).offset(M)},enable:function(){var I=this.options.button;I.removeClass("webuploader-pick-disable"),this.refresh()},disable:function(){var I=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"}),I.addClass("webuploader-pick-disable")},destroy:function(){var I=this.options.button;H(A).off("resize",this._resizeHandler),I.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}}),G}),B("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(D,E,F){var G=D.$;return G.extend(E.options,{pick:null,accept:null}),E.register({name:"picker",init:function(H){return this.pickers=[],H.pick&&this.addBtn(H.pick)},refresh:function(){G.each(this.pickers,function(){this.refresh()})},addBtn:function(H){var J=this,K=J.options,L=K.accept,I=[];if(H){return G.isPlainObject(H)||(H={id:H}),G(H.id).each(function(){var M,N,O;O=D.Deferred(),M=G.extend({},H,{accept:G.isPlainObject(L)?[L]:L,swf:K.swf,runtimeOrder:K.runtimeOrder,id:this}),N=new F(M),N.once("ready",O.resolve),N.on("select",function(P){J.owner.request("add-file",[P])}),N.init(),J.pickers.push(N),I.push(O.promise())}),D.when.apply(D,I)}},disable:function(){G.each(this.pickers,function(){this.disable()})},enable:function(){G.each(this.pickers,function(){this.enable()})},destroy:function(){G.each(this.pickers,function(){this.destroy()}),this.pickers=null}})}),B("lib/image",["base","runtime/client","lib/blob"],function(D,E,F){function G(I){this.options=H.extend({},G.options,I),E.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}var H=D.$;return G.options={quality:90,crop:!1,preserveHeaders:!1,allowMagnify:!1},D.inherits(E,{constructor:G,info:function(I){return I?(this._info=I,this):this._info},meta:function(I){return I?(this._meta=I,this):this._meta},loadFromBlob:function(I){var J=this,K=I.getRuid();this.connectRuntime(K,function(){J.exec("init",J.options),J.exec("loadFromBlob",I)})},resize:function(){var I=D.slice(arguments);return this.exec.apply(this,["resize"].concat(I))},crop:function(){var I=D.slice(arguments);return this.exec.apply(this,["crop"].concat(I))},getAsDataUrl:function(I){return this.exec("getAsDataUrl",I)},getAsBlob:function(I){var J=this.exec("getAsBlob",I);return new F(this.getRuid(),J)}}),G}),B("widgets/image",["base","uploader","lib/image","widgets/widget"],function(D,E,F){var G,H=D.$;return G=function(I){var J=0,K=[],L=function(){for(var M;K.length&&I>J;){M=K.shift(),J+=M[0],M[1]()}};return function(M,N,O){K.push([N,O]),M.once("destroy",function(){J-=N,setTimeout(L,1)}),setTimeout(L,1)}}(5242880),H.extend(E.options,{thumb:{width:110,height:110,quality:70,allowMagnify:!0,crop:!0,preserveHeaders:!1,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0}}),E.register({name:"image",makeThumb:function(I,J,M,N){var K,L;return I=this.request("get-file",I),I.type.match(/^image/)?(K=H.extend({},this.options.thumb),H.isPlainObject(M)&&(K=H.extend(K,M),M=null),M=M||K.width,N=N||K.height,L=new F(K),L.once("load",function(){I._info=I._info||L.info(),I._meta=I._meta||L.meta(),1>=M&&M>0&&(M=I._info.width*M),1>=N&&N>0&&(N=I._info.height*N),L.resize(M,N)}),L.once("complete",function(){J(!1,L.getAsDataUrl(K.type)),L.destroy()}),L.once("error",function(O){J(O||!0),L.destroy()}),void G(L,I.source.size,function(){I._info&&L.info(I._info),I._meta&&L.meta(I._meta),L.loadFromBlob(I.source)})):void J(!0)},beforeSendFile:function(J){var L,M,N=this.options.compress||this.options.resize,K=N&&N.compressSize||0,I=N&&N.noCompressIfLarger||!1;return J=this.request("get-file",J),!N||!~"image/jpeg,image/jpg".indexOf(J.type)||J.size<K||J._compressed?void 0:(N=H.extend({},N),M=D.Deferred(),L=new F(N),M.always(function(){L.destroy(),L=null}),L.once("error",M.reject),L.once("load",function(){var O=N.width,P=N.height;J._info=J._info||L.info(),J._meta=J._meta||L.meta(),1>=O&&O>0&&(O=J._info.width*O),1>=P&&P>0&&(P=J._info.height*P),L.resize(O,P)}),L.once("complete",function(){var O,P;try{O=L.getAsBlob(N.type),P=J.size,(!I||O.size<P)&&(J.source=O,J.size=O.size,J.trigger("resize",O.size,P)),J._compressed=!0,M.resolve()}catch(Q){M.resolve()}}),J._info&&L.info(J._info),J._meta&&L.meta(J._meta),L.loadFromBlob(J.source),M.promise())}})}),B("file",["base","mediator"],function(E,F){function G(){return J+K++}function H(M){this.name=M.name||"Untitled",this.size=M.size||0,this.type=M.type||"application/octet-stream",this.lastModifiedDate=M.lastModifiedDate||1*new Date,this.id=G(),this.ext=L.exec(this.name)?RegExp.$1:"",this.statusText="",D[this.id]=H.Status.INITED,this.source=M,this.loaded=0,this.on("error",function(N){this.setStatus(H.Status.ERROR,N)})}var I=E.$,J="WU_FILE_",K=0,L=/\.([^.]+)$/,D={};return I.extend(H.prototype,{setStatus:function(M,N){var O=D[this.id];"undefined"!=typeof N&&(this.statusText=N),M!==O&&(D[this.id]=M,this.trigger("statuschange",M,O))},getStatus:function(){return D[this.id]},getSource:function(){return this.source},destroy:function(){this.off(),delete D[this.id]}}),F.installTo(H.prototype),H.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"},H}),B("queue",["base","mediator","file"],function(D,E,F){function G(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numofDeleted:0,numofInterrupt:0},this._queue=[],this._map={}}var H=D.$,I=F.Status;return H.extend(G.prototype,{append:function(J){return this._queue.push(J),this._fileAdded(J),this},prepend:function(J){return this._queue.unshift(J),this._fileAdded(J),this},getFile:function(J){return"string"!=typeof J?J:this._map[J]},fetch:function(J){var K,L,M=this._queue.length;for(J=J||I.QUEUED,K=0;M>K;K++){if(L=this._queue[K],J===L.getStatus()){return L}}return null},sort:function(J){"function"==typeof J&&this._queue.sort(J)},getFiles:function(){for(var J,K=[].slice.call(arguments,0),L=[],M=0,N=this._queue.length;N>M;M++){J=this._queue[M],(!K.length||~H.inArray(J.getStatus(),K))&&L.push(J)}return L},removeFile:function(J){var K=this._map[J.id];K&&(delete this._map[J.id],J.destroy(),this.stats.numofDeleted++)},_fileAdded:function(J){var K=this,L=this._map[J.id];L||(this._map[J.id]=J,J.on("statuschange",function(M,N){K._onFileStatusChange(M,N)}))},_onFileStatusChange:function(J,K){var L=this.stats;switch(K){case I.PROGRESS:L.numOfProgress--;break;case I.QUEUED:L.numOfQueue--;break;case I.ERROR:L.numOfUploadFailed--;break;case I.INVALID:L.numOfInvalid--;break;case I.INTERRUPT:L.numofInterrupt--}switch(J){case I.QUEUED:L.numOfQueue++;break;case I.PROGRESS:L.numOfProgress++;break;case I.ERROR:L.numOfUploadFailed++;break;case I.COMPLETE:L.numOfSuccess++;break;case I.CANCELLED:L.numOfCancel++;break;case I.INVALID:L.numOfInvalid++;break;case I.INTERRUPT:L.numofInterrupt++}}}),E.installTo(G.prototype),G}),B("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(E,F,G,H,I,J){var K=E.$,L=/\.\w+$/,D=H.Status;return F.register({name:"queue",init:function(R){var S,T,U,M,N,O,P,Q=this;if(K.isPlainObject(R.accept)&&(R.accept=[R.accept]),R.accept){for(N=[],U=0,T=R.accept.length;T>U;U++){M=R.accept[U].extensions,M&&N.push(M)}N.length&&(O="\\."+N.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),Q.accept=new RegExp(O,"i")}return Q.queue=new G,Q.stats=Q.queue.stats,"html5"===this.request("predict-runtime-type")?(S=E.Deferred(),this.placeholder=P=new J("Placeholder"),P.connectRuntime({runtimeOrder:"html5"},function(){Q._ruid=P.getRuid(),S.resolve()}),S.promise()):void 0},_wrapFile:function(M){if(!(M instanceof H)){if(!(M instanceof I)){if(!this._ruid){throw new Error("Can't add external files.")}M=new I(this._ruid,M)}M=new H(M)}return M},acceptFile:function(M){var N=!M||!M.size||this.accept&&L.exec(M.name)&&!this.accept.test(M.name);return !N},_addFile:function(M){var N=this;return M=N._wrapFile(M),N.owner.trigger("beforeFileQueued",M)?N.acceptFile(M)?(N.queue.append(M),N.owner.trigger("fileQueued",M),M):void N.owner.trigger("error","Q_TYPE_DENIED",M):void 0},getFile:function(M){return this.queue.getFile(M)},addFile:function(M){var N=this;M.length||(M=[M]),M=K.map(M,function(O){return N._addFile(O)}),N.owner.trigger("filesQueued",M),N.options.auto&&setTimeout(function(){N.request("start-upload")},20)},getStats:function(){return this.stats},removeFile:function(M,N){var O=this;M=M.id?M:O.queue.getFile(M),this.request("cancel-file",M),N&&this.queue.removeFile(M)},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(M,N){var O,P,Q,R=this;if(M){return M=M.id?M:R.queue.getFile(M),M.setStatus(D.QUEUED),void (N||R.request("start-upload"))}for(O=R.queue.getFiles(D.ERROR),P=0,Q=O.length;Q>P;P++){M=O[P],M.setStatus(D.QUEUED)}R.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger("reset"),this.queue=new G,this.stats=this.queue.stats},destroy:function(){this.reset(),this.placeholder&&this.placeholder.destroy()}})}),B("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(D,E){return D.support=function(){return E.hasRuntime.apply(E,arguments)},D.register({name:"runtime",init:function(){if(!this.predictRuntimeType()){throw Error("Runtime Error")}},predictRuntimeType:function(){var F,G,H=this.options.runtimeOrder||E.orders,I=this.type;if(!I){for(H=H.split(/\s*,\s*/g),F=0,G=H.length;G>F;F++){if(E.hasRuntime(H[F])){this.type=I=H[F];break}}}return I}})}),B("lib/transport",["base","runtime/client","mediator"],function(D,E,F){function G(I){var J=this;I=J.options=H.extend(!0,{},G.options,I||{}),E.call(this,"Transport"),this._blob=null,this._formData=I.formData||{},this._headers=I.headers||{},this.on("progress",this._timeout),this.on("load error",function(){J.trigger("progress",1),clearTimeout(J._timer)})}var H=D.$;return G.options={server:"",method:"POST",withCredentials:!1,fileVal:"file",timeout:120000,formData:{},headers:{},sendAsBinary:!1},H.extend(G.prototype,{appendBlob:function(I,J,K){var L=this,M=L.options;L.getRuid()&&L.disconnectRuntime(),L.connectRuntime(J.ruid,function(){L.exec("init")}),L._blob=J,M.fileVal=I||M.fileVal,M.filename=K||M.filename},append:function(I,J){"object"==typeof I?H.extend(this._formData,I):this._formData[I]=J},setRequestHeader:function(I,J){"object"==typeof I?H.extend(this._headers,I):this._headers[I]=J},send:function(I){this.exec("send",I),this._timeout()},abort:function(){return clearTimeout(this._timer),this.exec("abort")},destroy:function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var I=this,J=I.options.timeout;J&&(clearTimeout(I._timer),I._timer=setTimeout(function(){I.abort(),I.trigger("error","timeout")},J))}}),F.installTo(G.prototype),G}),B("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(D,E,F,G){function H(N,O){var P,Q,R=[],S=N.source,T=S.size,U=O?Math.ceil(T/O):1,L=0,M=0;for(Q={file:N,has:function(){return !!R.length},shift:function(){return R.shift()},unshift:function(V){R.unshift(V)}};U>M;){P=Math.min(O,T-L),R.push({file:N,start:L,end:O?L+P:T,total:T,chunks:U,chunk:M++,cuted:Q}),L+=P}return N.blocks=R.concat(),N.remaning=R.length,Q}var I=D.$,J=D.isPromise,K=F.Status;I.extend(E.options,{prepareNextFile:!1,chunked:!1,chunkSize:5242880,chunkRetry:2,threads:3,formData:{}}),E.register({name:"upload",init:function(){var L=this.owner,M=this;this.runing=!1,this.progress=!1,L.on("startUpload",function(){M.progress=!0}).on("uploadFinished",function(){M.progress=!1}),this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this.__tick=D.bindFn(this._tick,this),L.on("uploadComplete",function(N){N.blocks&&I.each(N.blocks,function(O,P){P.transport&&(P.transport.abort(),P.transport.destroy()),delete P.transport}),delete N.blocks,delete N.remaning})},reset:function(){this.request("stop-upload",!0),this.runing=!1,this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this._trigged=!1,this._promise=null},startUpload:function(L){var M=this;if(I.each(M.request("get-files",K.INVALID),function(){M.request("remove-file",this)}),L){if(L=L.id?L:M.request("get-file",L),L.getStatus()===K.INTERRUPT){I.each(M.pool,function(O,P){P.file===L&&P.transport&&P.transport.send()}),L.setStatus(K.QUEUED)}else{if(L.getStatus()===K.PROGRESS){return}L.setStatus(K.QUEUED)}}else{I.each(M.request("get-files",[K.INITED]),function(){this.setStatus(K.QUEUED)})}if(!M.runing){M.runing=!0;var N=[];I.each(M.pool,function(O,P){var Q=P.file;Q.getStatus()===K.INTERRUPT&&(N.push(Q),M._trigged=!1,P.transport&&P.transport.send())});for(var L;L=N.shift();){L.setStatus(K.PROGRESS)}L||I.each(M.request("get-files",K.INTERRUPT),function(){this.setStatus(K.PROGRESS)}),M._trigged=!1,D.nextTick(M.__tick),M.owner.trigger("startUpload")}},stopUpload:function(L,M){var N=this;if(L===!0&&(M=L,L=null),N.runing!==!1){if(L){if(L=L.id?L:N.request("get-file",L),L.getStatus()!==K.PROGRESS&&L.getStatus()!==K.QUEUED){return}return L.setStatus(K.INTERRUPT),I.each(N.pool,function(O,P){P.file===L&&(P.transport&&P.transport.abort(),N._putback(P),N._popBlock(P))}),D.nextTick(N.__tick)}N.runing=!1,this._promise&&this._promise.file&&this._promise.file.setStatus(K.INTERRUPT),M&&I.each(N.pool,function(O,P){P.transport&&P.transport.abort(),P.file.setStatus(K.INTERRUPT)}),N.owner.trigger("stopUpload")}},cancelFile:function(L){L=L.id?L:this.request("get-file",L),L.blocks&&I.each(L.blocks,function(M,N){var O=N.transport;O&&(O.abort(),O.destroy(),delete N.transport)}),L.setStatus(K.CANCELLED),this.owner.trigger("fileDequeued",L)},isInProgress:function(){return !!this.progress},_getStats:function(){return this.request("get-stats")},skipFile:function(L,M){L=L.id?L:this.request("get-file",L),L.setStatus(M||K.COMPLETE),L.skipped=!0,L.blocks&&I.each(L.blocks,function(N,O){var P=O.transport;P&&(P.abort(),P.destroy(),delete O.transport)}),this.owner.trigger("uploadSkip",L)},_tick:function(){var L,M,N=this,O=N.options;return N._promise?N._promise.always(N.__tick):void (N.pool.length<O.threads&&(M=N._nextBlock())?(N._trigged=!1,L=function(P){N._promise=null,P&&P.file&&N._startSend(P),D.nextTick(N.__tick)},N._promise=J(M)?M.always(L):L(M)):N.remaning||N._getStats().numOfQueue||N._getStats().numofInterrupt||(N.runing=!1,N._trigged||D.nextTick(function(){N.owner.trigger("uploadFinished")}),N._trigged=!0))},_putback:function(L){var M;L.cuted.unshift(L),M=this.stack.indexOf(L.cuted),~M||this.stack.unshift(L.cuted)},_getStack:function(){for(var L,M=0;L=this.stack[M++];){if(L.has()&&L.file.getStatus()===K.PROGRESS){return L}(!L.has()||L.file.getStatus()!==K.PROGRESS&&L.file.getStatus()!==K.INTERRUPT)&&this.stack.splice(--M,1)}return null},_nextBlock:function(){var M,N,O,P,Q=this,L=Q.options;return(M=this._getStack())?(L.prepareNextFile&&!Q.pending.length&&Q._prepareNextFile(),M.shift()):Q.runing?(!Q.pending.length&&Q._getStats().numOfQueue&&Q._prepareNextFile(),N=Q.pending.shift(),O=function(R){return R?(M=H(R,L.chunked?L.chunkSize:0),Q.stack.push(M),M.shift()):null},J(N)?(P=N.file,N=N[N.pipe?"pipe":"then"](O),N.file=P,N):O(N)):void 0},_prepareNextFile:function(){var L,M=this,N=M.request("fetch-file"),O=M.pending;N&&(L=M.request("before-send-file",N,function(){return N.getStatus()===K.PROGRESS||N.getStatus()===K.INTERRUPT?N:M._finishFile(N)}),M.owner.trigger("uploadStart",N),N.setStatus(K.PROGRESS),L.file=N,L.done(function(){var P=I.inArray(L,O);~P&&O.splice(P,1,N)}),L.fail(function(P){N.setStatus(K.ERROR,P),M.owner.trigger("uploadError",N,P),M.owner.trigger("uploadComplete",N)}),O.push(L))},_popBlock:function(L){var M=I.inArray(L,this.pool);this.pool.splice(M,1),L.file.remaning--,this.remaning--},_startSend:function(L){var M,N=this,O=L.file;return O.getStatus()!==K.PROGRESS?void (O.getStatus()===K.INTERRUPT&&N._putback(L)):(N.pool.push(L),N.remaning++,L.blob=1===L.chunks?O.source:O.source.slice(L.start,L.end),M=N.request("before-send",L,function(){O.getStatus()===K.PROGRESS?N._doSend(L):(N._popBlock(L),D.nextTick(N.__tick))}),void M.fail(function(){1===O.remaning?N._finishFile(O).always(function(){L.percentage=1,N._popBlock(L),N.owner.trigger("uploadComplete",O),D.nextTick(N.__tick)}):(L.percentage=1,N.updateFileProgress(O),N._popBlock(L),D.nextTick(N.__tick))}))},_doSend:function(R){var S,T,U=this,L=U.owner,M=U.options,N=R.file,O=new G(M),P=I.extend({},M.formData),Q=I.extend({},M.headers);R.transport=O,O.on("destroy",function(){delete R.transport,U._popBlock(R),D.nextTick(U.__tick)}),O.on("progress",function(V){R.percentage=V,U.updateFileProgress(N)}),S=function(V){var W;return T=O.getResponseAsJson()||{},T._raw=O.getResponse(),W=function(X){V=X},L.trigger("uploadAccept",R,T,W)||(V=V||"server"),V},O.on("error",function(V,W){R.retried=R.retried||0,R.chunks>1&&~"http,abort".indexOf(V)&&R.retried<M.chunkRetry?(R.retried++,O.send()):(W||"server"!==V||(V=S(V)),N.setStatus(K.ERROR,V),L.trigger("uploadError",N,V),L.trigger("uploadComplete",N))}),O.on("load",function(){var V;return(V=S())?void O.trigger("error",V,!0):void (1===N.remaning?U._finishFile(N,T):O.destroy())}),P=I.extend(P,{id:N.id,name:N.name,type:N.type,lastModifiedDate:N.lastModifiedDate,size:N.size}),R.chunks>1&&I.extend(P,{chunks:R.chunks,chunk:R.chunk}),L.trigger("uploadBeforeSend",R,P,Q),O.appendBlob(M.fileVal,R.blob,N.name),O.append(P),O.setRequestHeader(Q),O.send()},_finishFile:function(L,M,N){var O=this.owner;return O.request("after-send-file",arguments,function(){L.setStatus(K.COMPLETE),O.trigger("uploadSuccess",L,M,N)}).fail(function(P){L.getStatus()===K.PROGRESS&&L.setStatus(K.ERROR,P),O.trigger("uploadError",L,P)}).always(function(){O.trigger("uploadComplete",L)})},updateFileProgress:function(L){var M=0,N=0;L.blocks&&(I.each(L.blocks,function(O,P){N+=(P.percentage||0)*(P.end-P.start)}),M=N/L.size,this.owner.trigger("uploadProgress",L,M||0))}})}),B("widgets/validator",["base","uploader","file","widgets/widget"],function(D,E,F){var G,H=D.$,I={};return G={addValidator:function(J,K){I[J]=K},removeValidator:function(J){delete I[J]}},E.register({name:"validator",init:function(){var J=this;D.nextTick(function(){H.each(I,function(){this.call(J.owner)})})}}),G.addValidator("fileNumLimit",function(){var J=this,K=J.options,L=0,M=parseInt(K.fileNumLimit,10),N=!0;M&&(J.on("beforeFileQueued",function(O){return L>=M&&N&&(N=!1,this.trigger("error","Q_EXCEED_NUM_LIMIT",M,O),setTimeout(function(){N=!0},1)),L>=M?!1:!0}),J.on("fileQueued",function(){L++}),J.on("fileDequeued",function(){L--}),J.on("reset",function(){L=0}))}),G.addValidator("fileSizeLimit",function(){var J=this,K=J.options,L=0,M=parseInt(K.fileSizeLimit,10),N=!0;M&&(J.on("beforeFileQueued",function(O){var P=L+O.size>M;return P&&N&&(N=!1,this.trigger("error","Q_EXCEED_SIZE_LIMIT",M,O),setTimeout(function(){N=!0},1)),P?!1:!0}),J.on("fileQueued",function(O){L+=O.size}),J.on("fileDequeued",function(O){L-=O.size}),J.on("reset",function(){L=0}))}),G.addValidator("fileSingleSizeLimit",function(){var J=this,K=J.options,L=K.fileSingleSizeLimit;L&&J.on("beforeFileQueued",function(M){return M.size>L?(M.setStatus(F.Status.INVALID,"exceed_size"),this.trigger("error","F_EXCEED_SIZE",L,M),!1):void 0})}),G.addValidator("duplicate",function(){function J(N){for(var O,P=0,Q=0,R=N.length;R>Q;Q++){O=N.charCodeAt(Q),P=O+(P<<6)+(P<<16)-P}return P}var K=this,L=K.options,M={};L.duplicate||(K.on("beforeFileQueued",function(N){var O=N.__hash||(N.__hash=J(N.name+N.size+N.lastModifiedDate));return M[O]?(this.trigger("error","F_DUPLICATE",N),!1):void 0}),K.on("fileQueued",function(N){var O=N.__hash;O&&(M[O]=!0)}),K.on("fileDequeued",function(N){var O=N.__hash;O&&delete M[O]}),K.on("reset",function(){M={}}))}),G}),B("lib/md5",["runtime/client","mediator"],function(D,E){function F(){D.call(this,"Md5")}return E.installTo(F.prototype),F.prototype.loadFromBlob=function(G){var H=this;H.getRuid()&&H.disconnectRuntime(),H.connectRuntime(G.ruid,function(){H.exec("init"),H.exec("loadFromBlob",G)})},F.prototype.getResult=function(){return this.exec("getResult")},F}),B("widgets/md5",["base","uploader","lib/md5","lib/blob","widgets/widget"],function(D,E,F,G){return E.register({name:"md5",md5File:function(H,K,L){var M=new F,I=D.Deferred(),J=H instanceof G?H:this.request("get-file",H).source;return M.on("progress load",function(N){N=N||{},I.notify(N.total?N.loaded/N.total:1)}),M.on("complete",function(){I.resolve(M.getResult())}),M.on("error",function(N){I.reject(N)}),arguments.length>1&&(K=K||0,L=L||0,0>K&&(K=J.size+K),0>L&&(L=J.size+L),L=Math.min(L,J.size),J=J.slice(K,L)),M.loadFromBlob(J),I.promise()}})}),B("runtime/compbase",[],function(){function D(E,F){this.owner=E,this.options=E.options,this.getRuntime=function(){return F},this.getRuid=function(){return F.uid},this.trigger=function(){return E.trigger.apply(E,arguments)}}return D}),B("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(D,E,F){function G(){var J={},K=this,L=this.destroy;E.apply(K,arguments),K.type=H,K.exec=function(O,Q){var R,M=this,P=M.uid,N=D.slice(arguments,2);return I[O]&&(R=J[P]=J[P]||new I[O](M,K),R[Q])?R[Q].apply(R,N):void 0},K.destroy=function(){return L&&L.apply(this,arguments)}}var H="html5",I={};return D.inherits(E,{constructor:G,init:function(){var J=this;setTimeout(function(){J.trigger("ready")},1)}}),G.register=function(J,K){var L=I[J]=D.inherits(F,K);return L},A.Blob&&A.FileReader&&A.DataView&&E.addRuntime(H,G),G}),B("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(D,E){return D.register("Blob",{slice:function(F,G){var H=this.owner.source,I=H.slice||H.webkitSlice||H.mozSlice;return H=I.call(H,F,G),new E(this.getRuid(),H)}})}),B("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(D,E,F){var G=D.$,H="webuploader-dnd-";return E.register("DragAndDrop",{init:function(){var I=this.elem=this.options.container;this.dragEnterHandler=D.bindFn(this._dragEnterHandler,this),this.dragOverHandler=D.bindFn(this._dragOverHandler,this),this.dragLeaveHandler=D.bindFn(this._dragLeaveHandler,this),this.dropHandler=D.bindFn(this._dropHandler,this),this.dndOver=!1,I.on("dragenter",this.dragEnterHandler),I.on("dragover",this.dragOverHandler),I.on("dragleave",this.dragLeaveHandler),I.on("drop",this.dropHandler),this.options.disableGlobalDnd&&(G(document).on("dragover",this.dragOverHandler),G(document).on("drop",this.dropHandler))},_dragEnterHandler:function(I){var J,K=this,L=K._denied||!1;return I=I.originalEvent||I,K.dndOver||(K.dndOver=!0,J=I.dataTransfer.items,J&&J.length&&(K._denied=L=!K.trigger("accept",J)),K.elem.addClass(H+"over"),K.elem[L?"addClass":"removeClass"](H+"denied")),I.dataTransfer.dropEffect=L?"none":"copy",!1},_dragOverHandler:function(I){var J=this.elem.parent().get(0);return J&&!G.contains(J,I.currentTarget)?!1:(clearTimeout(this._leaveTimer),this._dragEnterHandler.call(this,I),!1)},_dragLeaveHandler:function(){var I,J=this;return I=function(){J.dndOver=!1,J.elem.removeClass(H+"over "+H+"denied")},clearTimeout(J._leaveTimer),J._leaveTimer=setTimeout(I,100),!1},_dropHandler:function(I){var J,N,O=this,K=O.getRuid(),L=O.elem.parent().get(0);if(L&&!G.contains(L,I.currentTarget)){return !1}I=I.originalEvent||I,J=I.dataTransfer;try{N=J.getData("text/html")}catch(M){}return N?void 0:(O._getTansferFiles(J,function(P){O.trigger("drop",G.map(P,function(Q){return new F(K,Q)}))}),O.dndOver=!1,O.elem.removeClass(H+"over"),!1)},_getTansferFiles:function(M,N){var O,P,Q,R,S,I,J,K=[],L=[];for(O=M.items,P=M.files,J=!(!O||!O[0].webkitGetAsEntry),S=0,I=P.length;I>S;S++){Q=P[S],R=O&&O[S],J&&R.webkitGetAsEntry().isDirectory?L.push(this._traverseDirectoryTree(R.webkitGetAsEntry(),K)):K.push(Q)}D.when.apply(D,L).done(function(){K.length&&N(K)})},_traverseDirectoryTree:function(I,J){var K=D.Deferred(),L=this;return I.isFile?I.file(function(M){J.push(M),K.resolve()}):I.isDirectory&&I.createReader().readEntries(function(M){var P,Q=M.length,N=[],O=[];for(P=0;Q>P;P++){N.push(L._traverseDirectoryTree(M[P],O))}D.when.apply(D,N).then(function(){J.push.apply(J,O),K.resolve()},K.reject)}),K.promise()},destroy:function(){var I=this.elem;I&&(I.off("dragenter",this.dragEnterHandler),I.off("dragover",this.dragOverHandler),I.off("dragleave",this.dragLeaveHandler),I.off("drop",this.dropHandler),this.options.disableGlobalDnd&&(G(document).off("dragover",this.dragOverHandler),G(document).off("drop",this.dropHandler)))}})}),B("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(D,E,F){return E.register("FilePaste",{init:function(){var H,I,J,K,L=this.options,M=this.elem=L.container,G=".*";if(L.accept){for(H=[],I=0,J=L.accept.length;J>I;I++){K=L.accept[I].mimeTypes,K&&H.push(K)}H.length&&(G=H.join(","),G=G.replace(/,/g,"|").replace(/\*/g,".*"))}this.accept=G=new RegExp(G,"i"),this.hander=D.bindFn(this._pasteHander,this),M.on("paste",this.hander)},_pasteHander:function(H){var I,J,K,L,M,N=[],G=this.getRuid();for(H=H.originalEvent||H,I=H.clipboardData.items,L=0,M=I.length;M>L;L++){J=I[L],"file"===J.kind&&(K=J.getAsFile())&&N.push(new F(G,K))}N.length&&(H.preventDefault(),H.stopPropagation(),this.trigger("paste",N))},destroy:function(){this.elem.off("paste",this.hander)}})}),B("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(D,E){var F=D.$;return E.register("FilePicker",{init:function(){var J,K,L,M,N=this.getRuntime().getContainer(),O=this,P=O.owner,G=O.options,H=this.label=F(document.createElement("label")),I=this.input=F(document.createElement("input"));if(I.attr("type","file"),I.attr("name",G.name),I.addClass("webuploader-element-invisible"),H.on("click",function(){I.trigger("click")}),H.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"}),G.multiple&&I.attr("multiple","multiple"),G.accept&&G.accept.length>0){for(J=[],K=0,L=G.accept.length;L>K;K++){J.push(G.accept[K].mimeTypes)}I.attr("accept",J.join(","))}N.append(I),N.append(H),M=function(Q){P.trigger(Q.type)},I.on("change",function(Q){var R,S=arguments.callee;O.files=Q.target.files,R=this.cloneNode(!0),R.value=null,this.parentNode.replaceChild(R,this),I.off(),I=F(R).on("change",S).on("mouseenter mouseleave",M),P.trigger("change")}),H.on("mouseenter mouseleave",M)},getFiles:function(){return this.files},destroy:function(){this.input.off(),this.label.off()}})}),B("runtime/html5/util",["base"],function(D){var E=A.createObjectURL&&A||A.URL&&URL.revokeObjectURL&&URL||A.webkitURL,F=D.noop,G=F;return E&&(F=function(){return E.createObjectURL.apply(E,arguments)},G=function(){return E.revokeObjectURL.apply(E,arguments)}),{createObjectURL:F,revokeObjectURL:G,dataURL2Blob:function(H){var I,J,K,L,M,N;for(N=H.split(","),I=~N[0].indexOf("base64")?atob(N[1]):decodeURIComponent(N[1]),K=new ArrayBuffer(I.length),J=new Uint8Array(K),L=0;L<I.length;L++){J[L]=I.charCodeAt(L)}return M=N[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(K,M)},dataURL2ArrayBuffer:function(H){var I,J,K,L;for(L=H.split(","),I=~L[0].indexOf("base64")?atob(L[1]):decodeURIComponent(L[1]),J=new Uint8Array(I.length),K=0;K<I.length;K++){J[K]=I.charCodeAt(K)}return J.buffer},arrayBufferToBlob:function(H,I){var J,K=A.BlobBuilder||A.WebKitBlobBuilder;return K?(J=new K,J.append(H),J.getBlob(I)):new Blob([H],I?{type:I}:{})},canvasToDataUrl:function(H,I,J){return H.toDataURL(I,J/100)},parseMeta:function(H,I){I(!1,{})},updateImageHead:function(H){return H}}}),B("runtime/html5/imagemeta",["runtime/html5/util"],function(D){var E;return E={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(F,G){var H=this,I=new FileReader;I.onload=function(){G(!1,H._parse(this.result)),I=I.onload=I.onerror=null},I.onerror=function(J){G(J.message),I=I.onload=I.onerror=null},F=F.slice(0,H.maxMetaDataSize),I.readAsArrayBuffer(F.getSource())},_parse:function(J,K){if(!(J.byteLength<6)){var L,M,N,O,P=new DataView(J),F=2,G=P.byteLength-4,H=F,I={};if(65496===P.getUint16(0)){for(;G>F&&(L=P.getUint16(F),L>=65504&&65519>=L||65534===L)&&(M=P.getUint16(F+2)+2,!(F+M>P.byteLength));){if(N=E.parsers[L],!K&&N){for(O=0;O<N.length;O+=1){N[O].call(E,P,F,M,I)}}F+=M,H=F}H>6&&(I.imageHead=J.slice?J.slice(2,H):new Uint8Array(J).subarray(2,H))}return I}},updateImageHead:function(F,G){var H,I,J,K=this._parse(F,!0);return J=2,K.imageHead&&(J=2+K.imageHead.byteLength),I=F.slice?F.slice(J):new Uint8Array(F).subarray(J),H=new Uint8Array(G.byteLength+2+I.byteLength),H[0]=255,H[1]=216,H.set(new Uint8Array(G),2),H.set(new Uint8Array(I),G.byteLength+2),H.buffer}},D.parseMeta=function(){return E.parse.apply(E,arguments)},D.updateImageHead=function(){return E.updateImageHead.apply(E,arguments)},E}),B("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(D,E){var F={};return F.ExifMap=function(){return this},F.ExifMap.prototype.map={Orientation:274},F.ExifMap.prototype.get=function(G){return this[G]||this[this.map[G]]},F.exifTagTypes={1:{getValue:function(G,H){return G.getUint8(H)},size:1},2:{getValue:function(G,H){return String.fromCharCode(G.getUint8(H))},size:1,ascii:!0},3:{getValue:function(G,H,I){return G.getUint16(H,I)},size:2},4:{getValue:function(G,H,I){return G.getUint32(H,I)},size:4},5:{getValue:function(G,H,I){return G.getUint32(H,I)/G.getUint32(H+4,I)},size:8},9:{getValue:function(G,H,I){return G.getInt32(H,I)},size:4},10:{getValue:function(G,H,I){return G.getInt32(H,I)/G.getInt32(H+4,I)},size:8}},F.exifTagTypes[7]=F.exifTagTypes[1],F.getExifValue=function(N,O,P,Q,R,S){var G,H,I,J,K,L,M=F.exifTagTypes[Q];if(!M){return void D.log("Invalid Exif data: Invalid tag type.")}if(G=M.size*R,H=G>4?O+N.getUint32(P+8,S):P+8,H+G>N.byteLength){return void D.log("Invalid Exif data: Invalid data offset.")}if(1===R){return M.getValue(N,H,S)}for(I=[],J=0;R>J;J+=1){I[J]=M.getValue(N,H+J*M.size,S)}if(M.ascii){for(K="",J=0;J<I.length&&(L=I[J],"\x00"!==L);J+=1){K+=L}return K}return I},F.parseExifTag=function(G,H,I,J,K){var L=G.getUint16(I,J);K.exif[L]=F.getExifValue(G,H,I,G.getUint16(I+2,J),G.getUint32(I+4,J),J)},F.parseExifTags=function(H,I,J,K,L){var M,N,G;if(J+6>H.byteLength){return void D.log("Invalid Exif data: Invalid directory offset.")}if(M=H.getUint16(J,K),N=J+2+12*M,N+4>H.byteLength){return void D.log("Invalid Exif data: Invalid directory size.")}for(G=0;M>G;G+=1){this.parseExifTag(H,I,J+2+12*G,K,L)}return H.getUint32(N,K)},F.parseExifData=function(H,J,K,L){var M,I,G=J+10;if(1165519206===H.getUint32(J+4)){if(G+8>H.byteLength){return void D.log("Invalid Exif data: Invalid segment size.")}if(0!==H.getUint16(J+8)){return void D.log("Invalid Exif data: Missing byte alignment offset.")}switch(H.getUint16(G)){case 18761:M=!0;break;case 19789:M=!1;break;default:return void D.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==H.getUint16(G+2,M)){return void D.log("Invalid Exif data: Missing TIFF marker.")}I=H.getUint32(G+4,M),L.exif=new F.ExifMap,I=F.parseExifTags(H,G,G+I,M,L)}},E.parsers[65505].push(F.parseExifData),F}),B("runtime/html5/jpegencoder",[],function(){function D(AP){function AQ(H){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],J=0;64>J;J++){var K=Ax((I[J]*H+50)/100);1>K?K=1:K>255&&(K=255),Ay[Z[J]]=K}for(var L=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],M=0;64>M;M++){var N=Ax((L[M]*H+50)/100);1>N?N=1:N>255&&(N=255),Ap[Z[M]]=N}for(var O=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379],E=0,F=0;8>F;F++){for(var G=0;8>G;G++){Aq[E]=1/(Ay[Z[E]]*O[F]*O[G]*8),Ar[E]=1/(Ap[Z[E]]*O[F]*O[G]*8),E++}}}function AR(E,F){for(var G=0,H=0,I=new Array,J=1;16>=J;J++){for(var K=1;K<=E[J];K++){I[F[H]]=[],I[F[H]][0]=G,I[F[H]][1]=J,H++,G++}G*=2}return I}function AS(){AD=AR(Aa,Ab),AE=AR(Ae,Af),AF=AR(Ac,Ad),AG=AR(Ag,Y)}function AT(){for(var E=1,F=2,G=1;15>=G;G++){for(var H=E;F>H;H++){At[32767+H]=G,As[32767+H]=[],As[32767+H][1]=G,As[32767+H][0]=H}for(var I=-(F-1);-E>=I;I++){At[32767+I]=G,As[32767+I]=[],As[32767+I][1]=G,As[32767+I][0]=F-1+I}E<<=1,F<<=1}}function AU(){for(var E=0;256>E;E++){Ao[E]=19595*E,Ao[E+256>>0]=38470*E,Ao[E+512>>0]=7471*E+32768,Ao[E+768>>0]=-11059*E,Ao[E+1024>>0]=-21709*E,Ao[E+1280>>0]=32768*E+8421375,Ao[E+1536>>0]=-27439*E,Ao[E+1792>>0]=-5329*E}}function AV(E){for(var F=E[0],G=E[1]-1;G>=0;){F&1<<G&&(Ai|=1<<Aj),G--,Aj--,0>Aj&&(255==Ai?(AH(255),AH(0)):AH(Ai),Aj=7,Ai=0)}}function AH(E){Ah.push(An[E])}function AI(E){AH(E>>8&255),AH(255&E)}function AJ(BE,BF){var BG,BH,BI,BJ,BK,Bw,Bx,By,Bz,BA=0,BB=8,BC=64;for(Bz=0;BB>Bz;++Bz){BG=BE[BA],BH=BE[BA+1],BI=BE[BA+2],BJ=BE[BA+3],BK=BE[BA+4],Bw=BE[BA+5],Bx=BE[BA+6],By=BE[BA+7];var BD=BG+By,Bo=BG-By,Bp=BH+Bx,Bq=BH-Bx,Br=BI+Bw,Bs=BI-Bw,Bt=BJ+BK,Bu=BJ-BK,Bv=BD+Bt,Bl=BD-Bt,Bm=Bp+Br,Bn=Bp-Br;BE[BA]=Bv+Bm,BE[BA+4]=Bv-Bm;var Bf=0.707106781*(Bn+Bl);BE[BA+2]=Bl+Bf,BE[BA+6]=Bl-Bf,Bv=Bu+Bs,Bm=Bs+Bq,Bn=Bq+Bo;var Bg=0.382683433*(Bv-Bn),Bh=0.5411961*Bv+Bg,Bi=1.306562965*Bn+Bg,Bj=0.707106781*Bm,Bk=Bo+Bj,A7=Bo-Bj;BE[BA+5]=A7+Bh,BE[BA+3]=A7-Bh,BE[BA+1]=Bk+Bi,BE[BA+7]=Bk-Bi,BA+=8}for(BA=0,Bz=0;BB>Bz;++Bz){BG=BE[BA],BH=BE[BA+8],BI=BE[BA+16],BJ=BE[BA+24],BK=BE[BA+32],Bw=BE[BA+40],Bx=BE[BA+48],By=BE[BA+56];var A8=BG+By,A9=BG-By,Ba=BH+Bx,Bb=BH-Bx,Bc=BI+Bw,Bd=BI-Bw,Be=BJ+BK,AZ=BJ-BK,A0=A8+Be,A1=A8-Be,A2=Ba+Bc,A3=Ba-Bc;BE[BA]=A0+A2,BE[BA+32]=A0-A2;var A4=0.707106781*(A3+A1);BE[BA+16]=A1+A4,BE[BA+48]=A1-A4,A0=AZ+Bd,A2=Bd+Bb,A3=Bb+A9;var A5=0.382683433*(A0-A3),A6=0.5411961*A0+A5,F=1.306562965*A3+A5,AW=0.707106781*A2,AX=A9+AW,BL=A9-AW;BE[BA+40]=BL+A6,BE[BA+24]=BL-A6,BE[BA+8]=AX+F,BE[BA+56]=AX-F,BA++}var AY;for(Bz=0;BC>Bz;++Bz){AY=BE[Bz]*BF[Bz],Au[Bz]=AY>0?AY+0.5|0:AY-0.5|0}return Au}function AK(){AI(65504),AI(16),AH(74),AH(70),AH(73),AH(70),AH(0),AH(1),AH(1),AH(0),AI(1),AI(1),AH(0),AH(0)}function AL(E,F){AI(65472),AI(17),AH(8),AI(F),AI(E),AH(3),AH(1),AH(17),AH(0),AH(2),AH(17),AH(1),AH(3),AH(17),AH(1)}function AM(){AI(65499),AI(132),AH(0);for(var E=0;64>E;E++){AH(Ay[E])}AH(1);for(var F=0;64>F;F++){AH(Ap[F])}}function AN(){AI(65476),AI(418),AH(0);for(var F=0;16>F;F++){AH(Aa[F+1])}for(var G=0;11>=G;G++){AH(Ab[G])}AH(16);for(var H=0;16>H;H++){AH(Ac[H+1])}for(var I=0;161>=I;I++){AH(Ad[I])}AH(1);for(var J=0;16>J;J++){AH(Ae[J+1])}for(var K=0;11>=K;K++){AH(Af[K])}AH(17);for(var L=0;16>L;L++){AH(Ag[L+1])}for(var E=0;161>=E;E++){AH(Y[E])}}function AO(){AI(65498),AI(12),AH(3),AH(1),AH(0),AH(2),AH(17),AH(3),AH(17),AH(0),AH(63),AH(0)}function Az(S,T,U,V,W){for(var X,L=W[0],M=W[240],N=16,O=63,P=64,Q=AJ(S,T),R=0;P>R;++R){Av[Z[R]]=Q[R]}var E=Av[0]-U;U=Av[0],0==E?AV(V[0]):(X=32767+E,AV(V[At[X]]),AV(As[X]));for(var F=63;F>0&&0==Av[F];F--){}if(0==F){return AV(L),U}for(var G,H=1;F>=H;){for(var I=H;0==Av[H]&&F>=H;++H){}var J=H-I;if(J>=N){G=J>>4;for(var K=1;G>=K;++K){AV(M)}J=15&J}X=32767+Av[H],AV(W[(J<<4)+At[X]]),AV(As[X]),H++}return F!=O&&AV(L),U}function AA(){for(var E=String.fromCharCode,F=0;256>F;F++){An[F]=E(F)}}function AB(E){if(0>=E&&(E=1),E>100&&(E=100),Aw!=E){var F=0;F=Math.floor(50>E?5000/E:200-2*E),AQ(F),Aw=E}}function AC(){AP||(AP=50),AA(),AS(),AT(),AU(),AB(AP)}var AD,AE,AF,AG,Aw,Ax=(Math.round,Math.floor),Ay=new Array(64),Ap=new Array(64),Aq=new Array(64),Ar=new Array(64),As=new Array(65535),At=new Array(65535),Au=new Array(64),Av=new Array(64),Ah=[],Ai=0,Aj=7,Ak=new Array(64),Al=new Array(64),Am=new Array(64),An=new Array(256),Ao=new Array(2048),Z=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Aa=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Ab=[0,1,2,3,4,5,6,7,8,9,10,11],Ac=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Ad=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Ae=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Af=[0,1,2,3,4,5,6,7,8,9,10,11],Ag=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Y=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(S,T){T&&AB(T),Ah=new Array,Ai=0,Aj=7,AI(65496),AK(),AM(),AL(S.width,S.height),AN(),AO();var U=0,V=0,W=0;Ai=0,Aj=7,this.encode.displayName="_encode_";for(var X,L,M,J,K,o,H,I,i,k=S.data,l=S.width,m=S.height,n=4*l,g=0;m>g;){for(X=0;n>X;){for(K=n*g+X,o=K,H=-1,I=0,i=0;64>i;i++){I=i>>3,H=4*(7&i),o=K+I*n+H,g+I>=m&&(o-=n*(g+1+I-m)),X+H>=n&&(o-=X+H-n+4),L=k[o++],M=k[o++],J=k[o++],Ak[i]=(Ao[L]+Ao[M+256>>0]+Ao[J+512>>0]>>16)-128,Al[i]=(Ao[L+768>>0]+Ao[M+1024>>0]+Ao[J+1280>>0]>>16)-128,Am[i]=(Ao[L+1280>>0]+Ao[M+1536>>0]+Ao[J+1792>>0]>>16)-128}U=Az(Ak,Aq,U,AD,AF),V=Az(Al,Ar,V,AE,AG),W=Az(Am,Ar,W,AE,AG),X+=32}g+=8}if(Aj>=0){var O=[];O[1]=Aj+1,O[0]=(1<<Aj+1)-1,AV(O)}AI(65497);var R="data:image/jpeg;base64,"+btoa(Ah.join(""));return Ah=[],R},AC()}return D.encode=function(E,F){var G=new D(F);return G.encode(E)},D}),B("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(D,E,F){var G,H=D.canvasToDataUrl;D.canvasToDataUrl=function(M,N,O){var P,I,J,K,L;return F.os.android?("image/jpeg"===N&&"undefined"==typeof G&&(K=H.apply(null,arguments),L=K.split(","),K=~L[0].indexOf("base64")?atob(L[1]):decodeURIComponent(L[1]),K=K.substring(0,2),G=255===K.charCodeAt(0)&&216===K.charCodeAt(1)),"image/jpeg"!==N||G?H.apply(null,arguments):(I=M.width,J=M.height,P=M.getContext("2d"),E.encode(P.getImageData(0,0,I,J),O))):H.apply(null,arguments)}}),B("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(D,E,F){var G="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return E.register("Image",{modified:!1,init:function(){var H=this,I=new Image;I.onload=function(){H._info={type:H.type,width:this.width,height:this.height},H._metas||"image/jpeg"!==H.type?H.owner.trigger("load"):F.parseMeta(H._blob,function(J,K){H._metas=K,H.owner.trigger("load")})},I.onerror=function(){H.owner.trigger("error")},H._img=I},loadFromBlob:function(H){var I=this,J=I._img;I._blob=H,I.type=H.type,J.src=F.createObjectURL(H.getSource()),I.owner.once("load",function(){F.revokeObjectURL(J.src)})},resize:function(H,I){var J=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,J,H,I),this._blob=null,this.modified=!0,this.owner.trigger("complete","resize")},crop:function(K,L,M,N,O){var P=this._canvas||(this._canvas=document.createElement("canvas")),Q=this.options,R=this._img,H=R.naturalWidth,I=R.naturalHeight,J=this.getOrientation();O=O||1,P.width=M,P.height=N,Q.preserveHeaders||this._rotate2Orientaion(P,J),this._renderImageToCanvas(P,R,-K,-L,H*O,I*O),this._blob=null,this.modified=!0,this.owner.trigger("complete","crop")},getAsBlob:function(H){var I,J=this._blob,K=this.options;if(H=H||this.type,this.modified||this.type!==H){if(I=this._canvas,"image/jpeg"===H){if(J=F.canvasToDataUrl(I,H,K.quality),K.preserveHeaders&&this._metas&&this._metas.imageHead){return J=F.dataURL2ArrayBuffer(J),J=F.updateImageHead(J,this._metas.imageHead),J=F.arrayBufferToBlob(J,H)}}else{J=F.canvasToDataUrl(I,H)}J=F.dataURL2Blob(J)}return J},getAsDataUrl:function(H){var I=this.options;return H=H||this.type,"image/jpeg"===H?F.canvasToDataUrl(this._canvas,H,I.quality):this._canvas.toDataURL(H)},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(H){return H?(this._info=H,this):this._info},meta:function(H){return H?(this._meta=H,this):this._meta},destroy:function(){var H=this._canvas;this._img.onload=null,H&&(H.getContext("2d").clearRect(0,0,H.width,H.height),H.width=H.height=0,this._canvas=null),this._img.src=G,this._img=this._blob=null},_resize:function(M,N,O,P){var Q,R,S,T,H,I=this.options,J=M.width,K=M.height,L=this.getOrientation();~[5,6,7,8].indexOf(L)&&(O^=P,P^=O,O^=P),Q=Math[I.crop?"max":"min"](O/J,P/K),I.allowMagnify||(Q=Math.min(1,Q)),R=J*Q,S=K*Q,I.crop?(N.width=O,N.height=P):(N.width=R,N.height=S),T=(N.width-R)/2,H=(N.height-S)/2,I.preserveHeaders||this._rotate2Orientaion(N,L),this._renderImageToCanvas(N,M,T,H,R,S)},_rotate2Orientaion:function(H,I){var J=H.width,K=H.height,L=H.getContext("2d");switch(I){case 5:case 6:case 7:case 8:H.width=K,H.height=J}switch(I){case 2:L.translate(J,0),L.scale(-1,1);break;case 3:L.translate(J,K),L.rotate(Math.PI);break;case 4:L.translate(0,K),L.scale(1,-1);break;case 5:L.rotate(0.5*Math.PI),L.scale(1,-1);break;case 6:L.rotate(0.5*Math.PI),L.translate(0,-K);break;case 7:L.rotate(0.5*Math.PI),L.translate(J,-K),L.scale(-1,1);break;case 8:L.rotate(-0.5*Math.PI),L.translate(-J,0)}},_renderImageToCanvas:function(){function H(M,N,O){var P,Q,R,S=document.createElement("canvas"),T=S.getContext("2d"),J=0,K=O,L=O;for(S.width=1,S.height=O,T.drawImage(M,0,0),P=T.getImageData(0,0,1,O).data;L>J;){Q=P[4*(L-1)+3],0===Q?K=L:J=L,L=K+J>>1}return R=L/O,0===R?1:R}function I(J){var K,L,M=J.naturalWidth,N=J.naturalHeight;return M*N>1048576?(K=document.createElement("canvas"),K.width=K.height=1,L=K.getContext("2d"),L.drawImage(J,-M+1,0),0===L.getImageData(0,0,1,1).data[3]):!1}return D.os.ios?D.os.ios>=7?function(L,M,N,O,P,Q){var R=M.naturalWidth,J=M.naturalHeight,K=H(M,R,J);return L.getContext("2d").drawImage(M,0,0,R*K,J*K,N,O,P,Q)}:function(Z,b,c,x,y,R){var S,T,U,V,W,X,Y,J=b.naturalWidth,K=b.naturalHeight,L=Z.getContext("2d"),M=I(b),N="image/jpeg"===this.type,O=1024,P=0,Q=0;for(M&&(J/=2,K/=2),L.save(),S=document.createElement("canvas"),S.width=S.height=O,T=S.getContext("2d"),U=N?H(b,J,K):1,V=Math.ceil(O*y/J),W=Math.ceil(O*R/K/U);K>P;){for(X=0,Y=0;J>X;){T.clearRect(0,0,O,O),T.drawImage(b,-X,-P),L.drawImage(S,0,0,O,O,c+Y,x+Q,V,W),X+=O,Y+=V}P+=O,Q+=W}L.restore(),S=T=null}:function(J){var K=D.slice(arguments,1),L=J.getContext("2d");L.drawImage.apply(L,K)}}()})}),B("runtime/html5/transport",["base","runtime/html5/runtime"],function(D,E){var F=D.noop,G=D.$;return E.register("Transport",{init:function(){this._status=0,this._response=null},send:function(){var J,K,L,M=this.owner,N=this.options,O=this._initAjax(),H=M._blob,I=N.server;N.sendAsBinary?(I+=(/\?/.test(I)?"&":"?")+G.param(M._formData),K=H.getSource()):(J=new FormData,G.each(M._formData,function(P,Q){J.append(P,Q)}),J.append(N.fileVal,H.getSource(),N.filename||M._formData.name||"")),N.withCredentials&&"withCredentials" in O?(O.open(N.method,I,!0),O.withCredentials=!0):O.open(N.method,I),this._setRequestHeader(O,N.headers),K?(O.overrideMimeType&&O.overrideMimeType("application/octet-stream"),D.os.android?(L=new FileReader,L.onload=function(){O.send(this.result),L=L.onload=null},L.readAsArrayBuffer(K)):O.send(K)):O.send(J)},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var H=this._xhr;H&&(H.upload.onprogress=F,H.onreadystatechange=F,H.abort(),this._xhr=H=null)},destroy:function(){this.abort()},_initAjax:function(){var H=this,I=new XMLHttpRequest,J=this.options;return !J.withCredentials||"withCredentials" in I||"undefined"==typeof XDomainRequest||(I=new XDomainRequest),I.upload.onprogress=function(K){var L=0;return K.lengthComputable&&(L=K.loaded/K.total),H.trigger("progress",L)},I.onreadystatechange=function(){return 4===I.readyState?(I.upload.onprogress=F,I.onreadystatechange=F,H._xhr=null,H._status=I.status,I.status>=200&&I.status<300?(H._response=I.responseText,H.trigger("load")):I.status>=500&&I.status<600?(H._response=I.responseText,H.trigger("error","server")):H.trigger("error",H._status?"http":"abort")):void 0},H._xhr=I,I},_setRequestHeader:function(H,I){G.each(I,function(J,K){H.setRequestHeader(J,K)})},_parseJson:function(H){var I;try{I=JSON.parse(H)}catch(J){I={}}return I}})}),B("runtime/html5/md5",["runtime/html5/runtime"],function(N){var O=function(U,V){return U+V&4294967295},P=function(U,V,W,X,Y,Z){return V=O(O(V,U),O(X,Z)),O(V<<Y|V>>>32-Y,W)},Q=function(U,V,X,Y,Z,c,W){return P(V&X|~V&Y,U,V,Z,c,W)},R=function(U,V,X,Y,Z,c,W){return P(V&Y|X&~Y,U,V,Z,c,W)},S=function(U,V,X,Y,Z,c,W){return P(V^X^Y,U,V,Z,c,W)},T=function(U,V,X,Y,Z,c,W){return P(X^(V|~Y),U,V,Z,c,W)},F=function(V,W){var U=V[0],X=V[1],Y=V[2],Z=V[3];U=Q(U,X,Y,Z,W[0],7,-680876936),Z=Q(Z,U,X,Y,W[1],12,-389564586),Y=Q(Y,Z,U,X,W[2],17,606105819),X=Q(X,Y,Z,U,W[3],22,-1044525330),U=Q(U,X,Y,Z,W[4],7,-176418897),Z=Q(Z,U,X,Y,W[5],12,1200080426),Y=Q(Y,Z,U,X,W[6],17,-1473231341),X=Q(X,Y,Z,U,W[7],22,-45705983),U=Q(U,X,Y,Z,W[8],7,1770035416),Z=Q(Z,U,X,Y,W[9],12,-1958414417),Y=Q(Y,Z,U,X,W[10],17,-42063),X=Q(X,Y,Z,U,W[11],22,-1990404162),U=Q(U,X,Y,Z,W[12],7,1804603682),Z=Q(Z,U,X,Y,W[13],12,-40341101),Y=Q(Y,Z,U,X,W[14],17,-1502002290),X=Q(X,Y,Z,U,W[15],22,1236535329),U=R(U,X,Y,Z,W[1],5,-165796510),Z=R(Z,U,X,Y,W[6],9,-1069501632),Y=R(Y,Z,U,X,W[11],14,643717713),X=R(X,Y,Z,U,W[0],20,-373897302),U=R(U,X,Y,Z,W[5],5,-701558691),Z=R(Z,U,X,Y,W[10],9,38016083),Y=R(Y,Z,U,X,W[15],14,-660478335),X=R(X,Y,Z,U,W[4],20,-405537848),U=R(U,X,Y,Z,W[9],5,568446438),Z=R(Z,U,X,Y,W[14],9,-1019803690),Y=R(Y,Z,U,X,W[3],14,-187363961),X=R(X,Y,Z,U,W[8],20,1163531501),U=R(U,X,Y,Z,W[13],5,-1444681467),Z=R(Z,U,X,Y,W[2],9,-51403784),Y=R(Y,Z,U,X,W[7],14,1735328473),X=R(X,Y,Z,U,W[12],20,-1926607734),U=S(U,X,Y,Z,W[5],4,-378558),Z=S(Z,U,X,Y,W[8],11,-2022574463),Y=S(Y,Z,U,X,W[11],16,1839030562),X=S(X,Y,Z,U,W[14],23,-35309556),U=S(U,X,Y,Z,W[1],4,-1530992060),Z=S(Z,U,X,Y,W[4],11,1272893353),Y=S(Y,Z,U,X,W[7],16,-155497632),X=S(X,Y,Z,U,W[10],23,-1094730640),U=S(U,X,Y,Z,W[13],4,681279174),Z=S(Z,U,X,Y,W[0],11,-358537222),Y=S(Y,Z,U,X,W[3],16,-722521979),X=S(X,Y,Z,U,W[6],23,76029189),U=S(U,X,Y,Z,W[9],4,-640364487),Z=S(Z,U,X,Y,W[12],11,-421815835),Y=S(Y,Z,U,X,W[15],16,530742520),X=S(X,Y,Z,U,W[2],23,-995338651),U=T(U,X,Y,Z,W[0],6,-198630844),Z=T(Z,U,X,Y,W[7],10,1126891415),Y=T(Y,Z,U,X,W[14],15,-1416354905),X=T(X,Y,Z,U,W[5],21,-57434055),U=T(U,X,Y,Z,W[12],6,1700485571),Z=T(Z,U,X,Y,W[3],10,-1894986606),Y=T(Y,Z,U,X,W[10],15,-1051523),X=T(X,Y,Z,U,W[1],21,-2054922799),U=T(U,X,Y,Z,W[8],6,1873313359),Z=T(Z,U,X,Y,W[15],10,-30611744),Y=T(Y,Z,U,X,W[6],15,-1560198380),X=T(X,Y,Z,U,W[13],21,1309151649),U=T(U,X,Y,Z,W[4],6,-145523070),Z=T(Z,U,X,Y,W[11],10,-1120210379),Y=T(Y,Z,U,X,W[2],15,718787259),X=T(X,Y,Z,U,W[9],21,-343485551),V[0]=O(U,V[0]),V[1]=O(X,V[1]),V[2]=O(Y,V[2]),V[3]=O(Z,V[3])},G=function(U){var V,W=[];for(V=0;64>V;V+=4){W[V>>2]=U.charCodeAt(V)+(U.charCodeAt(V+1)<<8)+(U.charCodeAt(V+2)<<16)+(U.charCodeAt(V+3)<<24)}return W},H=function(U){var V,W=[];for(V=0;64>V;V+=4){W[V>>2]=U[V]+(U[V+1]<<8)+(U[V+2]<<16)+(U[V+3]<<24)}return W},I=function(W){var X,Y,Z,h,i,l,U=W.length,V=[1732584193,-271733879,-1732584194,271733878];for(X=64;U>=X;X+=64){F(V,G(W.substring(X-64,X)))}for(W=W.substring(X-64),Y=W.length,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=0;Y>X;X+=1){Z[X>>2]|=W.charCodeAt(X)<<(X%4<<3)}if(Z[X>>2]|=128<<(X%4<<3),X>55){for(F(V,Z),X=0;16>X;X+=1){Z[X]=0}}return h=8*U,h=h.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(h[2],16),l=parseInt(h[1],16)||0,Z[14]=i,Z[15]=l,F(V,Z),V},J=function(W){var X,Y,Z,h,j,l,U=W.length,V=[1732584193,-271733879,-1732584194,271733878];for(X=64;U>=X;X+=64){F(V,H(W.subarray(X-64,X)))}for(W=U>X-64?W.subarray(X-64):new Uint8Array(0),Y=W.length,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=0;Y>X;X+=1){Z[X>>2]|=W[X]<<(X%4<<3)}if(Z[X>>2]|=128<<(X%4<<3),X>55){for(F(V,Z),X=0;16>X;X+=1){Z[X]=0}}return h=8*U,h=h.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(h[2],16),l=parseInt(h[1],16)||0,Z[14]=j,Z[15]=l,F(V,Z),V},K=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],L=function(U){var V,W="";for(V=0;4>V;V+=1){W+=K[U>>8*V+4&15]+K[U>>8*V&15]}return W},M=function(U){var V;for(V=0;V<U.length;V+=1){U[V]=L(U[V])}return U.join("")},D=function(U){return M(I(U))},E=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==D("hello")&&(O=function(U,V){var W=(65535&U)+(65535&V),X=(U>>16)+(V>>16)+(W>>16);return X<<16|65535&W}),E.prototype.append=function(U){return/[\u0080-\uFFFF]/.test(U)&&(U=unescape(encodeURIComponent(U))),this.appendBinary(U),this},E.prototype.appendBinary=function(U){this._buff+=U,this._length+=U.length;var V,W=this._buff.length;for(V=64;W>=V;V+=64){F(this._state,G(this._buff.substring(V-64,V)))}return this._buff=this._buff.substr(V-64),this},E.prototype.end=function(U){var V,W,X=this._buff,Y=X.length,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(V=0;Y>V;V+=1){Z[V>>2]|=X.charCodeAt(V)<<(V%4<<3)}return this._finish(Z,Y),W=U?this._state:M(this._state),this.reset(),W},E.prototype._finish=function(U,V){var W,X,Y,Z=V;if(U[Z>>2]|=128<<(Z%4<<3),Z>55){for(F(this._state,U),Z=0;16>Z;Z+=1){U[Z]=0}}W=8*this._length,W=W.toString(16).match(/(.*?)(.{0,8})$/),X=parseInt(W[2],16),Y=parseInt(W[1],16)||0,U[14]=X,U[15]=Y,F(this._state,U)},E.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},E.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},E.hash=function(U,V){/[\u0080-\uFFFF]/.test(U)&&(U=unescape(encodeURIComponent(U)));var W=I(U);return V?W:M(W)},E.hashBinary=function(U,V){var W=I(U);return V?W:M(W)},E.ArrayBuffer=function(){this.reset()},E.ArrayBuffer.prototype.append=function(U){var V,W=this._concatArrayBuffer(this._buff,U),X=W.length;for(this._length+=U.byteLength,V=64;X>=V;V+=64){F(this._state,H(W.subarray(V-64,V)))}return this._buff=X>V-64?W.subarray(V-64):new Uint8Array(0),this},E.ArrayBuffer.prototype.end=function(U){var V,W,X=this._buff,Y=X.length,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(V=0;Y>V;V+=1){Z[V>>2]|=X[V]<<(V%4<<3)}return this._finish(Z,Y),W=U?this._state:M(this._state),this.reset(),W},E.ArrayBuffer.prototype._finish=E.prototype._finish,E.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},E.ArrayBuffer.prototype.destroy=E.prototype.destroy,E.ArrayBuffer.prototype._concatArrayBuffer=function(U,V){var W=U.length,X=new Uint8Array(W+V.byteLength);return X.set(U),X.set(new Uint8Array(V),W),X},E.ArrayBuffer.hash=function(U,V){var W=J(new Uint8Array(U));return V?W:M(W)},N.register("Md5",{init:function(){},loadFromBlob:function(X){var Y,Z,l=X.getSource(),m=2097152,n=Math.ceil(l.size/m),o=0,p=this.owner,U=new E.ArrayBuffer,V=this,W=l.mozSlice||l.webkitSlice||l.slice;Z=new FileReader,(Y=function(){var b,a;b=o*m,a=Math.min(b+m,l.size),Z.onload=function(c){U.append(c.target.result),p.trigger("progress",{total:X.size,loaded:a})},Z.onloadend=function(){Z.onloadend=Z.onload=null,++o<n?setTimeout(Y,1):setTimeout(function(){p.trigger("load"),V.result=U.end(),Y=X=l=U=null,p.trigger("complete")},50)},Z.readAsArrayBuffer(W.call(l,b,a))})()},getResult:function(){return this.result}})}),B("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(E,F,G){function H(){var L;try{L=navigator.plugins["Shockwave Flash"],L=L.description}catch(M){try{L=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(N){L="0.0"}}return L=L.match(/\d+/g),parseFloat(L[0]+"."+L[1],10)}function I(){function N(R,S){var T,U,V=R.type||R;T=V.split("::"),U=T[0],V=T[1],"Ready"===V&&U===L.uid?L.trigger("ready"):P[U]&&P[U].trigger(V.toLowerCase(),R,S)}var O={},P={},Q=this.destroy,L=this,M=E.guid("webuploader_");F.apply(L,arguments),L.type=K,L.exec=function(S,T){var U,W=this,R=W.uid,V=E.slice(arguments,2);return P[R]=W,D[S]&&(O[R]||(O[R]=new D[S](W,L)),U=O[R],U[T])?U[T].apply(U,V):L.flashExec.apply(W,arguments)},A[M]=function(){var R=arguments;setTimeout(function(){N.apply(null,R)},1)},this.jsreciver=M,this.destroy=function(){return Q&&Q.apply(this,arguments)},this.flashExec=function(R,S){var T=L.getFlash(),U=E.slice(arguments,2);return T.exec(this.uid,R,S,U)}}var J=E.$,K="flash",D={};return E.inherits(F,{constructor:I,init:function(){var L,M=this.getContainer(),N=this.options;M.css({position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),L='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+N.swf+'" ',E.browser.ie&&(L+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),L+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+N.swf+'" /><param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',M.html(L)},getFlash:function(){return this._flash?this._flash:(this._flash=J("#"+this.uid).get(0),this._flash)}}),I.register=function(L,M){return M=D[L]=E.inherits(G,J.extend({flashExec:function(){var N=this.owner,O=this.getRuntime();return O.flashExec.apply(N,arguments)}},M))},H()>=11.4&&F.addRuntime(K,I),I}),B("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(D,E){var F=D.$;return E.register("FilePicker",{init:function(G){var H,I,J=F.extend({},G);for(H=J.accept&&J.accept.length,I=0;H>I;I++){J.accept[I].title||(J.accept[I].title="Files")}delete J.button,delete J.id,delete J.container,this.flashExec("FilePicker","init",J)},destroy:function(){this.flashExec("FilePicker","destroy")}})}),B("runtime/flash/image",["runtime/flash/runtime"],function(D){return D.register("Image",{loadFromBlob:function(E){var F=this.owner;F.info()&&this.flashExec("Image","info",F.info()),F.meta()&&this.flashExec("Image","meta",F.meta()),this.flashExec("Image","loadFromBlob",E.uid)}})}),B("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(D,E,F){var G=D.$;return E.register("Transport",{init:function(){this._status=0,this._response=null,this._responseJson=null},send:function(){var H,I=this.owner,J=this.options,K=this._initAjax(),L=I._blob,M=J.server;K.connectRuntime(L.ruid),J.sendAsBinary?(M+=(/\?/.test(M)?"&":"?")+G.param(I._formData),H=L.uid):(G.each(I._formData,function(N,O){K.exec("append",N,O)}),K.exec("appendBlob",J.fileVal,L.uid,J.filename||I._formData.name||"")),this._setRequestHeader(K,J.headers),K.exec("send",{method:J.method,url:M,forceURLStream:J.forceURLStream,mimeType:"application/octet-stream"},H)},getStatus:function(){return this._status},getResponse:function(){return this._response||""},getResponseAsJson:function(){return this._responseJson},abort:function(){var H=this._xhr;H&&(H.exec("abort"),H.destroy(),this._xhr=H=null)},destroy:function(){this.abort()},_initAjax:function(){var H=this,I=new F("XMLHttpRequest");return I.on("uploadprogress progress",function(J){var K=J.loaded/J.total;return K=Math.min(1,Math.max(0,K)),H.trigger("progress",K)}),I.on("load",function(){var J,K=I.exec("getStatus"),L=!1,M="";return I.off(),H._xhr=null,K>=200&&300>K?L=!0:K>=500&&600>K?(L=!0,M="server"):M="http",L&&(H._response=I.exec("getResponse"),H._response=decodeURIComponent(H._response),J=A.JSON&&A.JSON.parse||function(N){try{return new Function("return "+N).call()}catch(O){return{}}},H._responseJson=H._response?J(H._response):{}),I.destroy(),I=null,M?H.trigger("error",M):H.trigger("load")}),I.on("error",function(){I.off(),H._xhr=null,H.trigger("error","http")}),H._xhr=I,I},_setRequestHeader:function(H,I){G.each(I,function(J,K){H.exec("setRequestHeader",J,K)})}})}),B("runtime/flash/blob",["runtime/flash/runtime","lib/blob"],function(D,E){return D.register("Blob",{slice:function(F,G){var H=this.flashExec("Blob","slice",F,G);return new E(H.uid,H)}})}),B("runtime/flash/md5",["runtime/flash/runtime"],function(D){return D.register("Md5",{init:function(){},loadFromBlob:function(E){return this.flashExec("Md5","loadFromBlob",E.uid)}})}),B("preset/all",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","widgets/md5","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/androidpatch","runtime/html5/image","runtime/html5/transport","runtime/html5/md5","runtime/flash/filepicker","runtime/flash/image","runtime/flash/transport","runtime/flash/blob","runtime/flash/md5"],function(D){return D}),B("widgets/log",["base","uploader","widgets/widget"],function(D,E){function F(L){var M=H.extend({},G,L),N=I.replace(/^(.*)\?/,"$1"+H.param(M)),O=new Image;O.src=N}var G,H=D.$,I=" http://static.tieba.baidu.com/tb/pms/img/st.gif??",J=(location.hostname||location.host||"protected").toLowerCase(),K=J&&/baidu/i.exec(J);if(K){return G={dv:3,master:"webuploader",online:/test/.exec(J)?0:1,module:"",product:J,type:0},E.register({name:"log",init:function(){var L=this.owner,M=0,N=0;L.on("error",function(O){F({type:2,c_error_code:O})}).on("uploadError",function(O,P){F({type:2,c_error_code:"UPLOAD_ERROR",c_reason:""+P})}).on("uploadComplete",function(O){M++,N+=O.size}).on("uploadFinished",function(){F({c_count:M,c_size:N}),M=N=0}),F({c_usage:1})}})}}),B("webuploader",["preset/all","widgets/log"],function(D){return D}),C("webuploader")});